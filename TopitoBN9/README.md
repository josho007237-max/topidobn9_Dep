# ü§ñ Topito BN9 ‚Äì Telegram Bot + Mini App Control Center

‡πÇ‡∏ã‡∏•‡∏π‡∏ä‡∏±‡∏ô‡∏Ñ‡∏£‡∏ö‡∏ß‡∏á‡∏à‡∏£‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£ Telegram Bot ‡∏´‡∏•‡∏≤‡∏¢‡∏ï‡∏±‡∏ß‡∏†‡∏≤‡∏¢‡πÉ‡∏ï‡πâ‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡πÄ‡∏î‡∏µ‡∏¢‡∏ß ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î React + Tailwind ‡∏ó‡∏µ‡πà‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏° Supabase ‡πÅ‡∏•‡∏∞ OpenAI ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ç‡∏¢‡∏≤‡∏¢‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå AI, Auto Command ‡πÅ‡∏•‡∏∞ Mini App ‡πÑ‡∏î‡πâ‡πÉ‡∏ô‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏î‡∏µ‡∏¢‡∏ß

## üåü Highlights

- **Multi-Bot Ready** ‚Äì ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏´‡∏•‡∏≤‡∏¢‡∏ö‡∏≠‡∏ó‡∏î‡πâ‡∏ß‡∏¢‡πÑ‡∏ü‡∏•‡πå `.env` ‡∏´‡∏£‡∏∑‡∏≠‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Supabase ‡πÅ‡∏•‡∏∞‡∏™‡∏•‡∏±‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å UI ‡πÄ‡∏î‡∏µ‡∏¢‡∏ß
- **Supabase Integration** ‚Äì ‡πÄ‡∏Å‡πá‡∏ö‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á, Quick Reply, Settings ‡πÅ‡∏•‡∏∞‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ Webhook ‡∏ö‡∏ô Supabase (‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö Service Role Key)
- **OpenAI Automation** ‚Äì ‡∏ó‡∏î‡∏•‡∏≠‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡∏à‡∏≤‡∏Å GPT-5 / GPT-4o / GPT-4-mini / GPT-3.5-turbo ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏≥‡∏´‡∏ô‡∏î Persona ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÅ‡∏ö‡∏£‡∏ô‡∏î‡πå
- **Mini App Dashboard** ‚Äì React + Tailwind UI ‡∏ó‡∏µ‡πà‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡πÉ‡∏´‡πâ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö Manifest, Deep Link ‡πÅ‡∏•‡∏∞ Telegram Stars ‡πÉ‡∏ô‡πÄ‡∏ü‡∏™‡∏ñ‡∏±‡∏î‡πÑ‡∏õ
- **Instant Deployment** ‚Äì Dockerfiles + docker-compose ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Backend + Frontend ‡πÅ‡∏•‡∏∞‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Netlify / Replit / Render / Firebase Hosting + Functions
- **Security by Design** ‚Äì ‡πÑ‡∏°‡πà‡∏°‡∏µ Token ‡πÉ‡∏ô‡∏ã‡∏≠‡∏£‡πå‡∏™‡πÇ‡∏Ñ‡πâ‡∏î ‡∏ó‡∏∏‡∏Å credentials ‡∏£‡∏±‡∏ö‡∏à‡∏≤‡∏Å `.env` / Secret Manager ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô

## üìÅ ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå

```
TopitoBN9/
‚îú‚îÄ‚îÄ backend/                 # Express API, Telegram Webhook, Supabase/OpenAI services
‚îÇ   ‚îú‚îÄ‚îÄ routes/              # REST API ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î (multi-bot)
‚îÇ   ‚îú‚îÄ‚îÄ services/            # Telegram, Supabase, OpenAI, storage adapters
‚îÇ   ‚îú‚îÄ‚îÄ data/bot-config.json # Local fallback store (‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πâ Supabase)
‚îÇ   ‚îî‚îÄ‚îÄ Dockerfile
‚îú‚îÄ‚îÄ frontend/                # React + Vite + Tailwind dashboard
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ tailwind.config.js
‚îÇ   ‚îú‚îÄ‚îÄ postcss.config.js
‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile
‚îÇ   ‚îî‚îÄ‚îÄ nginx.conf           # Production reverse proxy
‚îú‚îÄ‚îÄ functions/               # Firebase Cloud Functions wrapper (reuses Express app)
‚îú‚îÄ‚îÄ firebase.json            # Firebase Hosting + Functions configuration
‚îú‚îÄ‚îÄ .firebaserc              # Firebase project alias mapping
‚îú‚îÄ‚îÄ docker-compose.yml       # Stack ‡∏Ñ‡∏£‡∏ö‡∏ä‡∏∏‡∏î‡∏û‡∏£‡πâ‡∏≠‡∏° volume ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ö‡∏≠‡∏ó
‚îú‚îÄ‚îÄ .env.example             # ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á Environment Variables
‚îî‚îÄ‚îÄ README.md
```

## üîê Environment Variables

‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å `.env.example` ‡πÅ‡∏•‡πâ‡∏ß‡πÅ‡∏Å‡πâ‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô

```bash
cp .env.example .env
```

### Telegram

| Key | Description |
| --- | --- |
| `TELEGRAM_BOT_TOKEN` | ‡πÇ‡∏ó‡πÄ‡∏Ñ‡∏ô‡∏ö‡∏≠‡∏ó‡∏ï‡∏±‡∏ß‡∏´‡∏•‡∏±‡∏Å (‡∏ó‡∏≤‡∏á‡∏•‡∏±‡∏î‡∏Å‡∏£‡∏ì‡∏µ‡∏°‡∏µ‡∏ö‡∏≠‡∏ó‡πÄ‡∏î‡∏µ‡∏¢‡∏ß) |
| `TELEGRAM_BOT_NAME` / `TELEGRAM_BOT_USERNAME` | ‡πÉ‡∏ä‡πâ‡πÅ‡∏™‡∏î‡∏á‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏ô‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÉ‡∏ä‡πâ‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô |
| `TELEGRAM_BOTS` | JSON array ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö multi-bot ‡πÄ‡∏ä‡πà‡∏ô `[{"id":"main","name":"Topito","token":"000:ABC"}]` |
| `TELEGRAM_DEFAULT_BOT_ID` | ‡∏£‡∏´‡∏±‡∏™‡∏ö‡∏≠‡∏ó‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏´‡∏≤‡∏Å‡πÑ‡∏°‡πà‡∏™‡πà‡∏á‡πÉ‡∏ô webhook |

### Mini App & Webhook

| Key | Description |
| --- | --- |
| `DOMAIN` | ‡πÇ‡∏î‡πÄ‡∏°‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏£‡πâ‡∏≤‡∏á URL `https://DOMAIN/webhook/:botId` ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ |
| `MINIAPP_ID` | ‡πÉ‡∏ä‡πâ fallback ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏•‡∏¥‡∏á‡∏Å‡πå Mini App ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ |
| `MINIAPP_URL` | ‡∏£‡∏∞‡∏ö‡∏∏ URL ‡∏Ç‡∏≠‡∏á Mini App ‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á (‡πÄ‡∏ä‡πà‡∏ô Deep Link ‡∏´‡∏£‡∏∑‡∏≠ Stars) |

### Supabase

| Key | Description |
| --- | --- |
| `SUPABASE_URL` | URL ‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£ |
| `SUPABASE_ANON_KEY` | ‡πÉ‡∏ä‡πâ‡∏Å‡∏±‡∏ö‡∏ù‡∏±‡πà‡∏á Frontend |
| `SUPABASE_SERVICE_ROLE_KEY` | ‡πÉ‡∏ä‡πâ‡∏Å‡∏±‡∏ö Backend ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏≠‡πà‡∏≤‡∏ô/‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á (‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏´‡πâ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå Service Role) |

> Backend ‡∏à‡∏∞‡∏™‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡πÉ‡∏ä‡πâ‡πÑ‡∏ü‡∏•‡πå `data/bot-config.json` ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Supabase ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏ó‡∏î‡∏•‡∏≠‡∏á‡πÅ‡∏ö‡∏ö offline ‡πÑ‡∏î‡πâ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ

### OpenAI

| Key | Description |
| --- | --- |
| `OPENAI_API_KEY` | API key ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö GPT |
| `OPENAI_DEFAULT_MODEL` | ‡πÇ‡∏°‡πÄ‡∏î‡∏•‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô (‡πÄ‡∏ä‡πà‡∏ô `gpt-4o-mini`) |
| `OPENAI_SUPPORTED_MODELS` | ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏ó‡∏µ‡πà‡πÉ‡∏´‡πâ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÉ‡∏ô‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î |

### Frontend Runtime (Vite)

| Key | Description |
| --- | --- |
| `VITE_API_BASE` | URL ‡∏Ç‡∏≠‡∏á Backend ‡πÄ‡∏ä‡πà‡∏ô `http://localhost:3000` ‡∏´‡∏£‡∏∑‡∏≠ `https://api.bn9.club` |
| `VITE_SUPABASE_URL` / `VITE_SUPABASE_ANON_KEY` | ‡πÉ‡∏´‡πâ‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î‡∏ó‡∏£‡∏≤‡∏ö‡∏ß‡πà‡∏≤‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏° Supabase ‡πÑ‡∏î‡πâ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà |
| `VITE_OPENAI_MODEL` | ‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏ó‡∏µ‡πà‡πÅ‡∏™‡∏î‡∏á‡πÉ‡∏ô UI ‡πÄ‡∏ä‡πà‡∏ô `gpt-4o-mini` |

## üß† Supabase Schema Suggestion

‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ï‡πà‡∏≠‡πÑ‡∏õ‡∏ô‡∏µ‡πâ (‡∏´‡∏£‡∏∑‡∏≠‡∏õ‡∏£‡∏±‡∏ö‡∏ï‡∏≤‡∏°‡∏£‡∏∞‡∏ö‡∏ö‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì):

```sql
create table bots (
  id text primary key,
  name text,
  username text,
  description text,
  token text,
  webhook_url text,
  ai_persona text,
  ai_enabled boolean default false,
  miniapp_url text,
  last_synced_at timestamp,
  updated_at timestamp default now()
);

create table bot_commands (
  id uuid primary key,
  bot_id text references bots(id) on delete cascade,
  command text,
  description text,
  response text,
  buttons jsonb default '[]',
  created_at timestamp default now(),
  updated_at timestamp default now()
);

create table bot_quick_replies (
  id uuid primary key,
  bot_id text references bots(id) on delete cascade,
  title text,
  keyword text,
  response text,
  created_at timestamp default now(),
  updated_at timestamp default now()
);

create table bot_settings (
  bot_id text primary key references bots(id) on delete cascade,
  default_response text,
  ai_persona text,
  ai_enabled boolean default false,
  ai_model text,
  ai_temperature numeric,
  auto_keyboard boolean default false,
  auto_commands boolean default false,
  miniapp_url text,
  webhook_url text,
  updated_at timestamp default now()
);
```

> ‡∏°‡∏≠‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå Service Role ‡πÉ‡∏´‡πâ Backend ‡πÉ‡∏ä‡πâ `upsert`/`delete` ‡πÑ‡∏î‡πâ‡πÄ‡∏ï‡πá‡∏°‡∏ó‡∏µ‡πà ‡∏Ç‡∏ì‡∏∞‡∏ó‡∏µ‡πà Frontend ‡πÉ‡∏ä‡πâ Anon Key ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ö‡∏≠‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô

## üöÄ ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô (Local Dev)

> ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡πÇ‡∏õ‡∏£‡∏î‡∏±‡∏Å‡∏ä‡∏±‡∏ô? ‡∏î‡∏π [Deployment Playbook](./DEPLOYMENT_GUIDE.md) ‡∏ó‡∏µ‡πà‡∏™‡∏£‡∏∏‡∏õ‡∏ó‡∏∏‡∏Å‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡πÅ‡∏ö‡∏ö Runbook

### Backend

```bash
cd TopitoBN9/backend
npm install
npm start
```

Endpoints ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç:

- `POST /webhook/:botId` ‚Äì ‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏≤‡∏Å Telegram ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ö‡∏≠‡∏ó
- `POST /webhook` ‚Äì ‡πÉ‡∏ä‡πâ‡∏Ñ‡πà‡∏≤ `TELEGRAM_DEFAULT_BOT_ID` ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÑ‡∏°‡πà‡∏™‡πà‡∏á‡∏û‡∏≤‡∏£‡∏≤‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå
- `GET /health` ‚Äì ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏£‡∏∞‡∏ö‡∏ö‡∏£‡∏ß‡∏° (‡∏ö‡∏≠‡∏ó, Supabase, OpenAI, Local store)
- `GET /api/bots` ‚Äì ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏≠‡∏ó
- `GET /api/system/status` ‚Äì ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏£‡∏ß‡∏° Supabase/OpenAI/Webhook/Telegram
- `GET /api/bots/:botId/config` ‚Äì ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á + Quick Replies + Settings
- `POST /api/bots/:botId/commands` ‚Äì ‡πÄ‡∏û‡∏¥‡πà‡∏°/‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç/‡∏•‡∏ö‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á
- `POST /api/bots/:botId/quick-replies` ‚Äì ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Quick Replies
- `PUT /api/bots/:botId/settings` ‚Äì ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å Default Response, AI, Mini App URL, Webhook
- `POST /api/bots/:botId/test-message` ‚Äì ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÑ‡∏õ‡∏¢‡∏±‡∏á chat id
- `POST /api/bots/:botId/ai/preview` ‚Äì ‡∏Ç‡∏≠‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏à‡∏≤‡∏Å OpenAI ‡∏ï‡∏≤‡∏° Persona

### Frontend

```bash
cd TopitoBN9/frontend
npm install
npm run dev
```

‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î‡∏à‡∏∞‡∏£‡∏±‡∏ô‡∏ó‡∏µ‡πà `http://localhost:5173` ‡∏û‡∏£‡πâ‡∏≠‡∏° Tailwind UI ‡πÅ‡∏•‡∏∞‡πÄ‡∏£‡∏µ‡∏¢‡∏Å API ‡∏ú‡πà‡∏≤‡∏ô `VITE_API_BASE`

- ‡πÇ‡∏Ñ‡πâ‡∏î Frontend ‡πÄ‡∏õ‡πá‡∏ô React + **TypeScript** (Vite) ‡∏û‡∏£‡πâ‡∏≠‡∏° utility `src/api.ts` ‡∏ó‡∏µ‡πà‡∏ä‡πà‡∏ß‡∏¢‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ fetch/typing
- UI ‡∏ñ‡∏π‡∏Å‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡πÉ‡∏´‡πâ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏´‡∏•‡∏≤‡∏¢‡∏ö‡∏≠‡∏ó, ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á, Quick Reply ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ AI ‡πÑ‡∏î‡πâ‡∏Ñ‡∏£‡∏ö‡∏à‡∏ö‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏î‡∏µ‡∏¢‡∏ß

## üê≥ Deploy ‡∏î‡πâ‡∏ß‡∏¢ Docker Compose

```bash
cd TopitoBN9
cp .env.example .env  # ‡∏õ‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö ‡πÇ‡∏î‡∏¢‡πÄ‡∏â‡∏û‡∏≤‡∏∞ TELEGRAM_BOTS / SUPABASE / OPENAI
VITE_API_BASE=http://backend:3000 docker compose up --build
```

- Backend: `http://localhost:3000`
- Frontend (‡∏ú‡πà‡∏≤‡∏ô nginx): `http://localhost:8080`
- Volume `bot-data` ‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ü‡∏•‡πå `bot-config.json` ‡∏Å‡∏£‡∏ì‡∏µ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πâ Supabase

### Deploy ‡πÅ‡∏¢‡∏Å‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£

**Backend**
```bash
cd backend
docker build -t topito-backend .
docker run -p 3000:3000 --env-file ../.env topito-backend
```

**Frontend**
```bash
cd frontend
docker build -t topito-frontend --build-arg VITE_API_BASE=https://api.your-domain.com .
docker run -p 8080:80 topito-frontend
```

‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Netlify/Vercel ‡πÉ‡∏´‡πâ‡∏ï‡∏±‡πâ‡∏á build command = `npm run build`, publish directory = `dist`

## ‚òÅÔ∏è Firebase Hosting + Functions

‡∏ä‡∏∏‡∏î‡πÇ‡∏Ñ‡πâ‡∏î‡∏ô‡∏µ‡πâ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Ñ‡∏≠‡∏ô‡∏ü‡∏¥‡∏Å Firebase ‡πÑ‡∏ß‡πâ‡πÉ‡∏´‡πâ‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç (‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏¥‡∏î‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î):

| ‡πÑ‡∏ü‡∏•‡πå | ‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö/‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç |
| --- | --- |
| [`firebase.json`](./firebase.json) | `hosting.public` ‡∏ï‡πâ‡∏≠‡∏á‡∏ä‡∏µ‡πâ‡πÑ‡∏õ‡∏ó‡∏µ‡πà `frontend/dist`, `rewrites` ‡∏ï‡πâ‡∏≠‡∏á‡∏û‡∏≤ `/api/**` & `/webhook/**` ‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô `app`, ‡πÅ‡∏•‡∏∞ `hosting.predeploy` ‡∏à‡∏∞‡∏£‡∏±‡∏ô `npm --prefix frontend install && npm --prefix frontend run build` ‡πÉ‡∏´‡πâ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡∏Å‡πà‡∏≠‡∏ô deploy |
| [`.firebaserc`](./.firebaserc) | ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏Ñ‡πà‡∏≤ `default` ‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö Firebase Project ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì ‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏ä‡πâ `firebase use <project-id>` ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ |
| [`functions/index.js`](./functions/index.js) | ‡∏õ‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤ `runtimeOptions` ‡πÅ‡∏•‡∏∞‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô secrets ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÉ‡∏ô `runWith({ secrets: [...] })` ‡∏ñ‡πâ‡∏≤‡πÉ‡∏ä‡πâ Firebase Secret Manager |
| [`functions/package.json`](./functions/package.json) | ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÉ‡∏´‡πâ‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏ß‡πà‡∏≤ dependency `topito-backend` ‡∏¢‡∏±‡∏á‡∏ä‡∏µ‡πâ‡πÑ‡∏õ‡∏ó‡∏µ‡πà `file:../backend` (‡∏´‡∏≤‡∏Å‡∏¢‡πâ‡∏≤‡∏¢‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÉ‡∏´‡πâ‡πÅ‡∏Å‡πâ path ‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ) |
| [`functions/.env`](./functions/.env.example) | ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏à‡∏≤‡∏Å `.env` (‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏ä‡πâ `.env.example`) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ CLI ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏Ñ‡πà‡∏≤ environment ‡πÄ‡∏Ç‡πâ‡∏≤ Cloud Functions ‡∏ï‡∏≠‡∏ô deploy |

> ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï `.firebaserc` ‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå‡∏à‡∏£‡∏¥‡∏á‡∏Å‡πà‡∏≠‡∏ô deploy ‡πÄ‡∏™‡∏°‡∏≠ ‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏±‡∏ô `firebase use <project-id>` ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ú‡πà‡∏≤‡∏ô CLI

1. **‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á CLI** ‚Äì `npm install -g firebase-tools` ‡πÅ‡∏•‡πâ‡∏ß `firebase login`
2. **‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå** ‚Äì ‡πÅ‡∏Å‡πâ `.firebaserc` ‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏±‡∏ô `firebase use <project-id>`
3. **‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Environment** ‚Äì
   - ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á: `cp functions/.env.example functions/.env`
   - ‡πÄ‡∏ï‡∏¥‡∏°‡∏Ñ‡πà‡∏≤‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏Å‡∏±‡∏ö `.env` (‡πÄ‡∏ä‡πà‡∏ô `TELEGRAM_BOTS`, `DOMAIN`, `SUPABASE_URL`, `OPENAI_API_KEY`)
   - ‡∏´‡∏≤‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ Secret Manager ‡πÉ‡∏´‡πâ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ä‡∏∑‡πà‡∏≠‡∏•‡∏á‡πÉ‡∏ô `functions/index.js` ‡∏†‡∏≤‡∏¢‡πÉ‡∏ï‡πâ `runWith({ secrets: [...] })`
4. **‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á dependency** ‚Äì

   ```bash
   npm install --prefix TopitoBN9/backend
   npm install --prefix TopitoBN9/functions
   ```

   > ‡πÑ‡∏°‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡∏£‡∏±‡∏ô `npm install --prefix TopitoBN9/frontend` ‡∏•‡πà‡∏ß‡∏á‡∏´‡∏ô‡πâ‡∏≤ ‡∏´‡∏≤‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ CLI ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ ‡πÄ‡∏û‡∏£‡∏≤‡∏∞ `firebase.json` ‡∏°‡∏µ predeploy ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö frontend ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß

5. **Deploy** ‚Äì

   ```bash
   cd TopitoBN9
   firebase deploy
   ```

   - ‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á deploy, CLI ‡∏à‡∏∞‡πÄ‡∏£‡∏µ‡∏¢‡∏Å `npm --prefix frontend install` ‡πÅ‡∏•‡∏∞ `npm --prefix frontend run build` ‡∏ï‡∏≤‡∏° `hosting.predeploy`
   - Hosting ‡∏à‡∏∞‡πÄ‡∏™‡∏¥‡∏£‡πå‡∏ü‡πÑ‡∏ü‡∏•‡πå‡∏à‡∏≤‡∏Å `frontend/dist`
   - Cloud Function ‡∏ä‡∏∑‡πà‡∏≠ `app` ‡∏à‡∏∞‡∏ñ‡∏π‡∏Å rewrite ‡πÉ‡∏´‡πâ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö `/api/**` ‡πÅ‡∏•‡∏∞ `/webhook/**`

7. **‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö** ‚Äì ‡πÄ‡∏Ç‡πâ‡∏≤ `https://<project-id>.web.app/api/system/status` ‡∏´‡∏£‡∏∑‡∏≠ `https://<region>-<project-id>.cloudfunctions.net/app/health`
8. **‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÄ‡∏â‡∏û‡∏≤‡∏∞ Frontend** ‚Äì ‡πÉ‡∏ä‡πâ `firebase deploy --only hosting`

## üß™ ‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö Webhook

```bash
curl -X POST https://your-domain.com/webhook/primary \
  -H "Content-Type: application/json" \
  -d '{"message": {"chat": {"id": 12345}, "text": "/start"}}'
```

‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏î‡∏∂‡∏á‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏à‡∏≤‡∏Å Supabase (‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏ü‡∏•‡πå local) ‡πÅ‡∏•‡πâ‡∏ß‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö‡∏ú‡πà‡∏≤‡∏ô Telegram API ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ

## üîÆ Phase IV ‚Äì Next Upgrades

- ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏° **AI Generator** ‡πÅ‡∏ö‡∏ö‡πÄ‡∏ï‡πá‡∏°‡∏£‡∏π‡∏õ‡∏Å‡∏±‡∏ö Supabase ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏Å‡πá‡∏ö‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡πÅ‡∏•‡∏∞‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥
- ‡πÄ‡∏û‡∏¥‡πà‡∏° **Mini App Manifest** + Deep Link + Telegram Stars Payment
- ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô **Auto Keyboard / Auto Command Generation** ‡∏ú‡πà‡∏≤‡∏ô OpenAI
- ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö **Supabase Auth** ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏´‡∏•‡∏≤‡∏¢‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡πÉ‡∏ô‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï

## üìÑ License

‡πÄ‡∏ú‡∏¢‡πÅ‡∏û‡∏£‡πà‡∏†‡∏≤‡∏¢‡πÉ‡∏ï‡πâ MIT License ‚Äì ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ô‡∏≥‡πÑ‡∏õ‡∏õ‡∏£‡∏±‡∏ö‡πÉ‡∏ä‡πâ‡∏´‡∏£‡∏∑‡∏≠‡∏Ç‡∏¢‡∏≤‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏≠‡∏¥‡∏™‡∏£‡∏∞
